<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¹´í˜ í†µí•© ê´€ë¦¬ ì‹œìŠ¤í…œ (Cloud)</title>
    <style>
        /* (ì´ì „ ìŠ¤íƒ€ì¼ê³¼ ë™ì¼ - ì§€ë©´ìƒ ì¤‘ëµ) */
        :root { --primary: #4a3f35; --bg: #f5f5f5; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; }
        .hidden { display: none !important; }
        #login-container { max-width: 400px; margin: 100px auto; padding: 20px; background: white; border-radius: 10px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input, select, textarea { width: 100%; padding: 10px; margin: 5px 0; box-sizing: border-box; }
        button { width: 100%; padding: 10px; background: var(--primary); color: white; border: none; cursor: pointer; border-radius: 5px; }
        header { background: var(--primary); color: white; padding: 10px 20px; display: flex; justify-content: space-between; }
        .nav-tabs { display: flex; gap: 10px; padding: 10px; background: #eee; }
        .card { background: white; margin: 10px; padding: 15px; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    </style>
</head>
<body>

<div id="login-container">
    <h2>â˜• ì¹´í˜ ê´€ë¦¬ ë¡œê·¸ì¸</h2>
    <input type="text" id="user-id" placeholder="ì•„ì´ë””">
    <input type="password" id="user-pw" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <button onclick="handleLogin()">ë¡œê·¸ì¸</button>
</div>

<div id="main-app" class="hidden">
    <header>
        <span id="user-info"></span>
        <button onclick="location.reload()" style="width:auto;">ë¡œê·¸ì•„ì›ƒ</button>
    </header>
    <div class="nav-tabs">
        <button onclick="showTab('write')">ê¸°ë¡í•˜ê¸°</button>
        <button id="tab-admin" class="hidden" onclick="showTab('admin')">ì „ì²´ ì·¨í•©</button>
    </div>

    <div id="sec-write" class="card">
        <h3>ğŸ“ ì‹ ê·œ ë‚´ì—­ ê¸°ë¡</h3>
        <select id="log-type">
            <option value="ê³ ê° ì»´í”Œë ˆì¸">âš ï¸ ê³ ê° ì»´í”Œë ˆì¸</option>
            <option value="ì†ë‹˜ ìš”ì²­ì‚¬í•­">ğŸ’¬ ì†ë‹˜ ìš”ì²­ì‚¬í•­</option>
            <option value="ë§¤ì¥ ë³´ìˆ˜ í•„ìš”">ğŸ”§ ë§¤ì¥ ë³´ìˆ˜ í•„ìš”</option>
            <option value="ì§ì› ìš”ì²­ ì‚¬í•­">ğŸ™‹ ì§ì› ìš”ì²­ ì‚¬í•­</option>
        </select>
        <textarea id="log-content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
        <button onclick="saveLog()">êµ¬ê¸€ ì‹œíŠ¸ì— ì €ì¥</button>
    </div>

    <div id="sec-admin" class="card hidden">
        <h3>ğŸ“Š ì „ ë§¤ì¥ í†µí•© ë¦¬í¬íŠ¸</h3>
        <table id="admin-table">
            <thead><tr><th>ë‚ ì§œ</th><th>ë§¤ì¥</th><th>êµ¬ë¶„</th><th>ë‚´ìš©</th></tr></thead>
            <tbody id="admin-list"></tbody>
        </table>
    </div>
</div>

<script>
    const API_URL = "ì—¬ê¸°ì—_êµ¬ê¸€_ì•±ìŠ¤_ìŠ¤í¬ë¦½íŠ¸_URLì„_ë„£ìœ¼ì„¸ìš”"; 
    let currentUser = null;

    async function handleLogin() {
        const id = document.getElementById('user-id').value;
        const pw = document.getElementById('user-pw').value;
        
        const resp = await fetch(API_URL, {
            method: 'POST',
            body: JSON.stringify({ action: 'login', id, pw })
        });
        const result = await resp.text();

        if (result !== "Fail") {
            const data = JSON.parse(result);
            currentUser = { id, role: data.role };
            initApp();
        } else {
            alert("ë¡œê·¸ì¸ ì‹¤íŒ¨");
        }
    }

    function initApp() {
        document.getElementById('login-container').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('user-info').innerText = `${currentUser.id}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.`;
        if (currentUser.role === 'admin') document.getElementById('tab-admin').classList.remove('hidden');
    }

    function showTab(tabId) {
        document.getElementById('sec-write').classList.toggle('hidden', tabId !== 'write');
        document.getElementById('sec-admin').classList.toggle('hidden', tabId !== 'admin');
        if (tabId === 'admin') loadLogs();
    }

    async function saveLog() {
        const type = document.getElementById('log-type').value;
        const content = document.getElementById('log-content').value;
        const branch = currentUser.role === 'admin' ? 'ë³¸ì‚¬' : (currentUser.id.includes('1') ? '1í˜¸ì ' : '2í˜¸ì ');

        await fetch(API_URL, {
            method: 'POST',
            body: JSON.stringify({ action: 'saveLog', id: currentUser.id, branch, type, content })
        });
        alert("ì‹œíŠ¸ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
        document.getElementById('log-content').value = '';
    }

    async function loadLogs() {
        const resp = await fetch(API_URL);
        const data = await resp.json();
        const list = document.getElementById('admin-list');
        list.innerHTML = '';
        data.slice(1).reverse().forEach(row => {
            list.innerHTML += `<tr><td>${new Date(row[0]).toLocaleDateString()}</td><td>${row[2]}</td><td>${row[3]}</td><td>${row[4]}</td></tr>`;
        });
    }
</script>
</body>
</html>
